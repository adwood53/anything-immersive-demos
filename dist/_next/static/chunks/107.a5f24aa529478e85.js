(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{3107:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var n=i(5155),r=i(2115),a=i(8441),c=i.n(a);let l=()=>{let e=(0,r.useRef)(null),t=(0,r.useRef)(null),a=(0,r.useRef)({x:0,y:0,z:0}),l=(0,r.useRef)(!1),o=(0,r.useRef)({x:0,y:0,z:0});return(0,r.useEffect)(()=>{(async()=>{let n=e.current,r=t.current,c=r.getContext("2d",{alpha:!1,desynchronized:!0}),[{AlvaAR:h},{Camera:d,resize2cover:s,onFrame:u}]=await Promise.all([i.e(834).then(i.bind(i,7834)),i.e(165).then(i.bind(i,8165))]),f=(await d.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,y=s(f.videoWidth,f.videoHeight,n.clientWidth,n.clientHeight);r.width=n.clientWidth,r.height=n.clientHeight,f.style.width="".concat(y.width,"px"),f.style.height="".concat(y.height,"px");let x=await h.Initialize(r.width,r.height);n.appendChild(r),document.body.addEventListener("click",()=>x.reset(),!1),u(()=>{if(c.clearRect(0,0,r.width,r.height),!document.hidden){c.drawImage(f,0,0,f.videoWidth,f.videoHeight,y.x,y.y,y.width,y.height);let e=c.getImageData(0,0,r.width,r.height),t=x.findCameraPose(e);if(t){let e=new THREE.Vector3(t[12],t[13],t[14]),i=document.querySelector("a-camera");if(l.current){a.current=0;let e=i.getAttribute("rotation");o.current={x:e.x,y:e.y,z:e.z},i.setAttribute("position","0 0 0"),i.setAttribute("rotation-offset","\n                pitch: ".concat(-o.current.x,"; \n                yaw: ").concat(-o.current.y,"; \n                roll: ").concat(-o.current.z,";\n              "))}else{let t={x:e.x-a.current.x,y:e.y-a.current.y,z:e.z-a.current.z},n=i.getAttribute("position");i.setAttribute("position",{x:n.x+t.x,y:n.y-t.y,z:n.z-t.z})}a.current={x:e.x,y:e.y,z:e.z},l.current=!1}else for(let e of(l.current=!0,x.getFramePoints()))c.fillStyle="white",c.fillRect(e.x,e.y,2,2)}return!0},30)})().catch(e=>{console.error("Error initializing SLAM:",e)})},[]),(0,n.jsx)("div",{className:"".concat(c().container),ref:e,children:(0,n.jsx)("canvas",{ref:t})})}},8441:e=>{e.exports={container:"DeviceCamera_container__j2VGQ",fadeIn:"DeviceCamera_fadeIn__Cr6HF",splash:"DeviceCamera_splash__bimCV",overlay:"DeviceCamera_overlay__fOsCB"}}}]);