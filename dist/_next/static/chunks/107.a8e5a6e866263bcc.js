(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{3107:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var r=i(5155),n=i(2115),a=i(8441),c=i.n(a);let l=()=>{let e=(0,n.useRef)(null),t=(0,n.useRef)(null),a=(0,n.useRef)({x:0,y:0,z:0}),l=(0,n.useRef)(!1);return(0,n.useEffect)(()=>{(async()=>{let r=e.current,n=t.current,c=n.getContext("2d",{alpha:!1,desynchronized:!0}),[{AlvaAR:h},{Camera:d,resize2cover:o,onFrame:s}]=await Promise.all([i.e(834).then(i.bind(i,7834)),i.e(165).then(i.bind(i,8165))]),u=(await d.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,f=o(u.videoWidth,u.videoHeight,r.clientWidth,r.clientHeight);n.width=r.clientWidth,n.height=r.clientHeight,u.style.width="".concat(f.width,"px"),u.style.height="".concat(f.height,"px");let y=await h.Initialize(n.width,n.height);r.appendChild(n),document.body.addEventListener("click",()=>y.reset(),!1),s(()=>{if(c.clearRect(0,0,n.width,n.height),!document.hidden){c.drawImage(u,0,0,u.videoWidth,u.videoHeight,f.x,f.y,f.width,f.height);let e=c.getImageData(0,0,n.width,n.height),t=y.findCameraPose(e);if(t){let e=new THREE.Vector3(t[12],t[13],t[14]),i=document.querySelector("a-camera"),r=i.getAttribute("position");if(l.current)r.current=0,a.current=0,i.setAttribute("position","0 0 0");else{let t={x:e.x-a.current.x,y:e.y-a.current.y,z:e.z-a.current.z};i.setAttribute("position",{x:r.x+t.x,y:r.y-t.y,z:r.z-t.z})}a.current={x:e.x,y:e.y,z:e.z},l.current=!1}else for(let e of(l.current=!0,y.getFramePoints()))c.fillStyle="white",c.fillRect(e.x,e.y,2,2)}return!0},30)})().catch(e=>{console.error("Error initializing SLAM:",e)})},[]),(0,r.jsx)("div",{className:"".concat(c().container),ref:e,children:(0,r.jsx)("canvas",{ref:t})})}},8441:e=>{e.exports={container:"DeviceCamera_container__j2VGQ",fadeIn:"DeviceCamera_fadeIn__Cr6HF",splash:"DeviceCamera_splash__bimCV",overlay:"DeviceCamera_overlay__fOsCB"}}}]);