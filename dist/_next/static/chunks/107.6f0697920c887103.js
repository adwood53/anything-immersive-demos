(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{3107:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var a=i(5155),n=i(2115),r=i(8441),c=i.n(r);let o=()=>{let e=(0,n.useRef)(null),t=(0,n.useRef)(null),r=(0,n.useRef)(!1),o=(0,n.useRef)(!0);return(0,n.useRef)({x:0,y:0,z:0}),(0,n.useEffect)(()=>{let a=document.querySelector("a-camera");a.parentNode;let n=async()=>{let[{AlvaAR:n},{Camera:r,resize2cover:c,onFrame:l}]=await Promise.all([i.e(834).then(i.bind(i,7834)),i.e(165).then(i.bind(i,8165))]),h=e.current,d=t.current,s=(await r.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,u=c(s.videoWidth,s.videoHeight,h.clientWidth,h.clientHeight);d.width=h.clientWidth,d.height=h.clientHeight,s.style.width="".concat(u.width,"px"),s.style.height="".concat(u.height,"px");let f=await n.Initialize(d.width,d.height);document.body.addEventListener("click",()=>f.reset(),!1);let g=d.getContext("2d",{alpha:!1,desynchronized:!0});l(()=>{if(g.clearRect(0,0,d.width,d.height),!document.hidden){g.drawImage(s,0,0,s.videoWidth,s.videoHeight,u.x,u.y,u.width,u.height);let e=g.getImageData(0,0,d.width,d.height),t=f.findCameraPose(e);if(t){console.log("have");let e=new THREE.Vector3(t[12],t[13],t[14]),i=new THREE.Matrix4().fromArray(t),n=new THREE.Quaternion().setFromRotationMatrix(i);a.setAttribute("position","".concat(e.x," ").concat(-e.y," ").concat(-e.z)),a.setAttribute("rotation","".concat(-n.x," ").concat(n.y," ").concat(n.z))}else for(let e of(console.log("lost"),o.current=!0,f.getFramePoints()))g.fillStyle="white",g.fillRect(e.x,e.y,2,2)}return!0},30)};r.current||(n().catch(e=>{console.error("Error initializing SLAM:",e)}),r.current=!0)},[]),(0,a.jsx)("div",{className:"".concat(c().container),ref:e,children:(0,a.jsx)("canvas",{ref:t})})}},8441:e=>{e.exports={container:"DeviceCamera_container__j2VGQ",fadeIn:"DeviceCamera_fadeIn__Cr6HF",splash:"DeviceCamera_splash__bimCV",overlay:"DeviceCamera_overlay__fOsCB"}}}]);