(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{3107:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(5155),r=i(2115),a=i(8441),c=i.n(a);let o=()=>{let e=(0,r.useRef)(null),t=(0,r.useRef)(null),a=(0,r.useRef)({x:0,y:0,z:0}),o=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{(async()=>{let n=e.current,r=t.current,c=r.getContext("2d",{alpha:!1,desynchronized:!0}),[{AlvaAR:l},{Camera:h,resize2cover:d,onFrame:s}]=await Promise.all([i.e(834).then(i.bind(i,7834)),i.e(165).then(i.bind(i,8165))]),u=(await h.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,f=d(u.videoWidth,u.videoHeight,n.clientWidth,n.clientHeight);r.width=n.clientWidth,r.height=n.clientHeight,u.style.width="".concat(f.width,"px"),u.style.height="".concat(f.height,"px");let y=await l.Initialize(r.width,r.height);n.appendChild(r),document.body.addEventListener("click",()=>y.reset(),!1),s(()=>{if(c.clearRect(0,0,r.width,r.height),!document.hidden){c.drawImage(u,0,0,u.videoWidth,u.videoHeight,f.x,f.y,f.width,f.height);let e=c.getImageData(0,0,r.width,r.height),t=y.findCameraPose(e);if(t){let e=new THREE.Vector3(t[12],t[13],t[14]),i=document.querySelector("a-camera");if(o.current){a.current=0,i.setAttribute("position","0 0 0");let e=i.getAttribute("rotation"),t=i.getAttribute("rotation-offset");i.setAttribute("rotation-offset","\n                pitch: ".concat(t.x-e.x,"; \n                yaw: ").concat(t.y-e.y,"; \n                roll: ").concat(t.z-e.z,";\n              "))}else{let t={x:e.x-a.current.x,y:e.y-a.current.y,z:e.z-a.current.z},n=i.getAttribute("position");i.setAttribute("position",{x:n.x+t.x,y:n.y-t.y,z:n.z-t.z})}a.current={x:e.x,y:e.y,z:e.z},o.current=!1}else for(let e of(o.current=!0,y.getFramePoints()))c.fillStyle="white",c.fillRect(e.x,e.y,2,2)}return!0},30)})().catch(e=>{console.error("Error initializing SLAM:",e)})},[]),(0,n.jsx)("div",{className:"".concat(c().container),ref:e,children:(0,n.jsx)("canvas",{ref:t})})}},8441:e=>{e.exports={container:"DeviceCamera_container__j2VGQ",fadeIn:"DeviceCamera_fadeIn__Cr6HF",splash:"DeviceCamera_splash__bimCV",overlay:"DeviceCamera_overlay__fOsCB"}}}]);