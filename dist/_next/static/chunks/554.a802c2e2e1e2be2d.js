"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[554],{1554:(t,e,i)=>{i.r(e),i.d(e,{default:()=>a});var o=i(5155),n=i(2115);let a=function(t){let{config:e={}}=t,{format:i="gltf",rotateY:a=!0,rotateZ:s=!0,position:l="0 0.5 -1",rotation:c="0 0 0",scale:r="1 1 1",modelPosition:d="0 -0.25 0",frustumCulled:h=!0,animationEnabled:u=!1,animationClip:m="*",useRegExp:p=!1,duration:E=0,crossFadeDuration:b=0,loop:f="repeat",repetitions:g=1/0,timeScale:v=1,clampWhenFinished:y=!1,startAt:R=0,modelId:A="",assetId:S="model",mtlAssetId:x="material",selectable:L=!0}=e;(0,n.useEffect)(()=>{if(!window.AFRAME)return;AFRAME.components["disable-culling"]||AFRAME.registerComponent("disable-culling",{init(){this.el.addEventListener("model-loaded",()=>{let t=this.el.getObject3D("mesh");t&&t.traverse(t=>{t.isMesh&&(t.frustumCulled=!1)})})}}),AFRAME.components["model-control"]||AFRAME.registerComponent("model-control",{schema:{rotateY:{type:"boolean",default:!0},rotateZ:{type:"boolean",default:!0},modelId:{type:"string"},selectable:{type:"boolean",default:!0}},init(){let t=this.el.object3D.position;this.initialPosition={x:t.x,y:t.y,z:t.z},this.currentPosition={...this.initialPosition},this.touchStart={x:0,y:0},this.currentRotation={y:90,z:0},this.isRotating=!1,this.isSelected=!1,this.setupTouchEvents(),this.setupSelectionEvents(),this.updateRotation();let e=new CustomEvent("model-registered",{detail:{modelId:this.data.modelId,element:this.el}});this.el.sceneEl.dispatchEvent(e)},remove(){let t=new CustomEvent("model-unregistered",{detail:{modelId:this.data.modelId}});this.el.sceneEl.dispatchEvent(t)},setupSelectionEvents(){this.data.selectable&&(this.el.classList.add("selectable"),this.el.addEventListener("click",()=>{this.isSelected=!this.isSelected,this.el.emit("model-selection-changed",{modelId:this.data.modelId,selected:this.isSelected}),this.el.setAttribute("scale",this.isSelected?"1.1 1.1 1.1":"1 1 1")}),this.el.addEventListener("mouseenter",()=>{this.isSelected||this.el.setAttribute("scale","1.05 1.05 1.05")}),this.el.addEventListener("mouseleave",()=>{this.isSelected||this.el.setAttribute("scale","1 1 1")}))},setupTouchEvents(){let t=document.querySelector("canvas");if(!t)return;document.addEventListener("contextmenu",t=>t.preventDefault());let e=e=>{e.target===t&&(e.preventDefault(),this.isRotating=!0,this.touchStart.x="touchstart"===e.type?e.touches[0].clientX:e.clientX,this.touchStart.y="touchstart"===e.type?e.touches[0].clientY:e.clientY)},i=t=>{if(!this.isRotating)return;t.preventDefault();let e="touchmove"===t.type?t.touches[0].clientX:t.clientX,i="touchmove"===t.type?t.touches[0].clientY:t.clientY;if(this.data.rotateY){let t=e-this.touchStart.x;this.currentRotation.y+=.25*t}if(this.data.rotateZ){let t=i-this.touchStart.y;this.currentRotation.z+=.25*t}this.updateRotation(),this.touchStart.x=e,this.touchStart.y=i},o=()=>{this.isRotating=!1};t.addEventListener("touchstart",e,{passive:!1}),t.addEventListener("touchmove",i,{passive:!1}),t.addEventListener("touchend",o),t.addEventListener("mousedown",e),t.addEventListener("mousemove",i),t.addEventListener("mouseup",o)},updatePosition(t){this.currentPosition.z+=t,this.currentPosition.z=Math.max(this.initialPosition.z-1,Math.min(this.initialPosition.z+.7,this.currentPosition.z)),this.el.object3D.position.z=this.currentPosition.z},resetModel(){this.currentPosition={...this.initialPosition},this.currentRotation={y:90,z:0},this.el.object3D.position.copy(this.initialPosition),this.updateRotation()},updateRotation(){this.data.rotateY&&(this.el.object3D.rotation.y=THREE.MathUtils.degToRad(this.currentRotation.y)),this.data.rotateZ&&(this.el.object3D.rotation.z=THREE.MathUtils.degToRad(this.currentRotation.z))}}),AFRAME.components["animation-mixer-control"]||AFRAME.registerComponent("animation-mixer-control",{schema:{enabled:{type:"boolean",default:!1},clip:{type:"string",default:"*"},useRegExp:{type:"boolean",default:!1},duration:{type:"number",default:0},crossFadeDuration:{type:"number",default:0},loop:{type:"string",default:"repeat"},repetitions:{type:"number",default:1/0},timeScale:{type:"number",default:1},clampWhenFinished:{type:"boolean",default:!1},startAt:{type:"number",default:0}},init(){let t=this;this.el.addEventListener("model-loaded",function(){if(!t.data.enabled)return;let e=t.el.getObject3D("mesh");if(!e)return;let i=new THREE.AnimationMixer(e),o=e.animations||t.el.animations;if(!o)return;let n=t.data.useRegExp?new RegExp(t.data.clip):t.data.clip,a=o.filter(t=>"string"==typeof n?t.name===n:n.test(t.name));a.length&&a.forEach(e=>{let o=i.clipAction(e);o.loop="once"===t.data.loop?THREE.LoopOnce:"pingpong"===t.data.loop?THREE.LoopPingPong:THREE.LoopRepeat,o.repetitions="once"===t.data.loop?1:t.data.repetitions,o.clampWhenFinished=t.data.clampWhenFinished,o.timeScale=t.data.timeScale,o.startAt=t.data.startAt,o.play()}),t.mixer=i})},tick(t,e){this.mixer&&this.mixer.update(e/1e3)}});let t=document.querySelector("#model-container-".concat(A," [").concat("gltf"===i?"gltf-model":"obj-model","]"));t&&("obj"===i?t.setAttribute("obj-model","obj: #".concat(S,"; mtl: #").concat(x)):t.setAttribute("gltf-model","#".concat(S)))},[e]);let j="gltf"===i?{"gltf-model":"#".concat(S)}:{"obj-model":"obj: #".concat(S,"; mtl: #").concat(x)};return(0,o.jsx)("a-entity",{id:"model-container-".concat(A),class:"model-container",position:l,scale:r,rotation:c,"model-control":"\n        rotateY: ".concat(a,"; \n        rotateZ: ").concat(s,"; \n        modelId: ").concat(A,";\n        selectable: ").concat(L,"\n      "),children:(0,o.jsx)("a-entity",{...j,position:d,shadow:"cast: true; receive: true","disable-culling":h?void 0:"",...u?{"animation-mixer-control":"\n            enabled: ".concat(u,"; \n            clip: ").concat(m,"; \n            useRegExp: ").concat(p,"; \n            duration: ").concat(E,"; \n            crossFadeDuration: ").concat(b,"; \n            loop: ").concat(f,"; \n            repetitions: ").concat(g,"; \n            timeScale: ").concat(v,"; \n            clampWhenFinished: ").concat(y,"; \n            startAt: ").concat(R,"\n          ")}:{}})})}}}]);