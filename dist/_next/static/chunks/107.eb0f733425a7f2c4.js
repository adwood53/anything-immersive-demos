(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{3107:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var i=r(5155),n=r(2115),a=r(8441),c=r.n(a);let l=()=>{let e=(0,n.useRef)(null),t=(0,n.useRef)(null),a=(0,n.useRef)(!1);(0,n.useRef)(!0);let l=(0,n.useRef)(new THREE.Vector3(0,0,0)),o=(0,n.useRef)(new THREE.Quaternion(0,0,0,1));return(0,n.useEffect)(()=>{let i=document.querySelector("a-camera");i.parentNode;let n=async()=>{let[{AlvaAR:n},{Camera:a,resize2cover:c,onFrame:u}]=await Promise.all([r.e(834).then(r.bind(r,7834)),r.e(165).then(r.bind(r,8165))]),h=e.current,d=t.current,s=(await a.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,f=c(s.videoWidth,s.videoHeight,h.clientWidth,h.clientHeight);d.width=h.clientWidth,d.height=h.clientHeight,s.style.width="".concat(f.width,"px"),s.style.height="".concat(f.height,"px");let w=await n.Initialize(d.width,d.height);document.body.addEventListener("click",()=>w.reset(),!1);let m=d.getContext("2d",{alpha:!1,desynchronized:!0});u(()=>{if(m.clearRect(0,0,d.width,d.height),!document.hidden){m.drawImage(s,0,0,s.videoWidth,s.videoHeight,f.x,f.y,f.width,f.height);let e=m.getImageData(0,0,d.width,d.height),t=w.findCameraPose(e);if(t){let e=new THREE.Vector3(t[12],t[13],t[14]),r=new THREE.Matrix4().fromArray(t),n=new THREE.Quaternion().setFromRotationMatrix(r),a=new THREE.Vector3(l.current.x,l.current.y,l.current.z),c=new THREE.Quaternion(o.current.x,o.current.y,o.current.z,o.current.w).normalize(),u=a.lerp(e,.5),h=c.slerp(n.normalize(),.5).normalize();l.current=u,o.current=h,i.setAttribute("position",{x:l.current.x,y:-l.current.y,z:-l.current.z}),i.setAttribute("quaternion-rotation",{x:-o.current.x,y:o.current.y,z:o.current.z,w:o.current.w})}else for(let e of w.getFramePoints())m.fillStyle="white",m.fillRect(e.x,e.y,2,2)}return!0},30)};a.current||(n().catch(e=>{console.error("Error initializing SLAM:",e)}),a.current=!0)},[]),(0,i.jsx)("div",{className:"".concat(c().container),ref:e,children:(0,i.jsx)("canvas",{ref:t})})}},8441:e=>{e.exports={container:"DeviceCamera_container__j2VGQ",fadeIn:"DeviceCamera_fadeIn__Cr6HF",splash:"DeviceCamera_splash__bimCV",overlay:"DeviceCamera_overlay__fOsCB"}}}]);