(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{3107:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>l});var n=i(5155),r=i(2115),a=i(8441),c=i.n(a);let l=()=>{let e=(0,r.useRef)(null),t=(0,r.useRef)(null),a=(0,r.useRef)(!1);(0,r.useRef)(!0);let l=(0,r.useRef)(new THREE.Vector3(0,0,0));return(0,r.useRef)(new THREE.Quaternion(0,0,0,1)),(0,r.useEffect)(()=>{let n=document.querySelector("a-camera");n.parentNode;let r=async()=>{let[{AlvaAR:r},{Camera:a,resize2cover:c,onFrame:h}]=await Promise.all([i.e(834).then(i.bind(i,7834)),i.e(165).then(i.bind(i,8165))]),d=e.current,o=t.current,s=(await a.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,u=c(s.videoWidth,s.videoHeight,d.clientWidth,d.clientHeight);o.width=d.clientWidth,o.height=d.clientHeight,s.style.width="".concat(u.width,"px"),s.style.height="".concat(u.height,"px");let f=await r.Initialize(o.width,o.height);document.body.addEventListener("click",()=>f.reset(),!1);let w=o.getContext("2d",{alpha:!1,desynchronized:!0});h(()=>{if(w.clearRect(0,0,o.width,o.height),!document.hidden){w.drawImage(s,0,0,s.videoWidth,s.videoHeight,u.x,u.y,u.width,u.height);let e=w.getImageData(0,0,o.width,o.height),t=f.findCameraPose(e);if(t){let e=new THREE.Vector3(t[12],t[13],t[14]),i=new THREE.Vector3(l.current.x,l.current.y,l.current.z).lerp(e,.5);n.setAttribute("position",{x:i.x,y:-i.y,z:-i.z}),l.current=i}else for(let e of f.getFramePoints())w.fillStyle="white",w.fillRect(e.x,e.y,2,2)}return!0},30)};a.current||(r().catch(e=>{console.error("Error initializing SLAM:",e)}),a.current=!0)},[]),(0,n.jsx)("div",{className:"".concat(c().container),ref:e,children:(0,n.jsx)("canvas",{ref:t})})}},8441:e=>{e.exports={container:"DeviceCamera_container__j2VGQ",fadeIn:"DeviceCamera_fadeIn__Cr6HF",splash:"DeviceCamera_splash__bimCV",overlay:"DeviceCamera_overlay__fOsCB"}}}]);