(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[497],{2497:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>m});var a=n(5155),i=n(2115),r=n(2494),l=n.n(r);let o={valueDisplay:{fontSize:"13px",color:"white"}},s=e=>{let{text:t}=e;return(0,a.jsx)("span",{style:o.valueDisplay,children:t})};var c=n(3755),u=n.n(c);let d={container:{gap:"5px",display:"flex",flexDirection:"column"}},h=e=>{let{onValueChanged:t,minValue:n=0,maxValue:r=1,defaultValue:l=.5,step:o=.1,label:c="Label"}=e,[h,x]=(0,i.useState)(l);return(0,a.jsxs)("div",{style:d.container,children:[(0,a.jsx)(s,{text:"".concat(c," ").concat(h)}),(0,a.jsx)("input",{type:"range",min:n,max:r,step:o,value:h,onChange:e=>{let n=e.target.value;x(n),t&&t(n)},className:u().slider})]})},x={container:{alignItems:"left",fontFamily:"Arial, sans-serif"},toggle:{width:"50px",height:"20px",borderRadius:"12px",display:"flex",alignItems:"left",padding:"2.5px",cursor:"pointer",transition:"background-color 0.3s ease",position:"relative"},knob:{width:"15px",height:"15px",backgroundColor:"#fff",borderRadius:"50%",transition:"transform 0.3s ease"}},f=function(e){let{onToggle:t,defaultState:n=!1,label:r}=e,[l,o]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{o(n)},[n]),(0,a.jsxs)("div",{style:x.container,children:[(0,a.jsx)(s,{text:r}),(0,a.jsx)("div",{style:{...x.toggle,backgroundColor:l?"#7466E2":"#ccc"},onClick:()=>{let e=!l;o(e),t&&t(e)},children:(0,a.jsx)("div",{style:{...x.knob,transform:l?"translateX(30px)":"translateX(0)"}})})]})},g={button:{padding:"2.5px 15px",backgroundColor:"#E79023",color:"#fff",border:"none",borderRadius:"5px",fontSize:"16px",cursor:"pointer",transition:"background-color 0.3s ease"}},p=function(e){let{onClick:t,label:n="Button",style:i={}}=e;return(0,a.jsx)("button",{style:{...g.button,...i},onClick:t,children:(0,a.jsx)(s,{text:n})})},m=()=>{let e=(0,i.useRef)(!1),[t,r]=(0,i.useState)(!1),o=(0,i.useRef)(null),s=(0,i.useRef)(null);(0,i.useRef)(!0);let c=(0,i.useRef)(new THREE.Vector3(0,0,0)),u=(0,i.useRef)(new THREE.Quaternion(0,0,0,1));(0,i.useRef)(new THREE.Quaternion(0,0,0,1));let d=(0,i.useRef)(null),x=40,g=.95,m=!1,b=!0,y=!1;return(0,i.useEffect)(()=>{let t=document.querySelector("a-camera"),a=async()=>{let[{AlvaAR:e},{Camera:t,resize2cover:a,onFrame:r}]=await Promise.all([n.e(834).then(n.bind(n,7834)),n.e(165).then(n.bind(n,8165))]),h=o.current,f=s.current,p=(await t.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,w=a(p.videoWidth,p.videoHeight,h.clientWidth,h.clientHeight);f.width=h.clientWidth,f.height=h.clientHeight,p.style.width="".concat(w.width,"px"),p.style.height="".concat(w.height,"px");let E=await e.Initialize(f.width,f.height,45,x,g,b,m,y);d.current=E,document.body.addEventListener("click",()=>E.reset(),!1);let R=f.getContext("2d",{alpha:!1,desynchronized:!0});r(()=>{if(R.clearRect(0,0,f.width,f.height),!document.hidden){R.drawImage(p,0,0,p.videoWidth,p.videoHeight,w.x,w.y,w.width,w.height);let e=R.getImageData(0,0,f.width,f.height),t=E.findCameraPose(e);if(t){let e=new THREE.Vector3(t[12],t[13],t[14]),n=new THREE.Matrix4().fromArray(t),a=new THREE.Quaternion().setFromRotationMatrix(n).normalize();e.y=-e.y,e.z=-e.z,a.x=-a.x,c.current=c.current.lerp(e,.5),u.current=u.current.normalize().slerp(a,.5).normalize(),i(c.current),l(u.current)}else for(let e of E.getFramePoints())R.fillStyle="white",R.fillRect(e.x,e.y,2,2)}return!0},30)};e.current||(e.current=!0,a().then(()=>{r(!0)}).catch(e=>{console.error("Error initializing SLAM:",e)}));let i=e=>{t.setAttribute("position",{x:e.x,y:e.y,z:e.z})},l=e=>{t.setAttribute("quaternion-rotation",{x:e.x,y:e.y,z:e.z,w:e.w})}},[]),(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsxs)("div",{className:"".concat(l().debugContainer),children:[(0,a.jsx)(h,{onValueChanged:e=>{x=e},minValue:10,maxValue:100,defaultValue:x,step:1,label:"Frame Max Cell Size:"}),(0,a.jsx)(h,{onValueChanged:e=>{g=e},minValue:0,maxValue:1,defaultValue:g,step:.01,label:"Map Keyframe Filtering Ratio:"}),(0,a.jsx)(f,{onToggle:e=>{m=e},defaultState:m,label:"Use CLAHE"}),(0,a.jsx)(f,{onToggle:e=>{b=e},defaultState:b,label:"Use P3P"}),(0,a.jsx)(f,{onToggle:e=>{y=e},defaultState:y,label:"Debug Logs"}),(0,a.jsx)(p,{onClick:function(){d.current.reconfigure(x,g,b,m,y)},label:"APPLY"})]}),(0,a.jsx)("div",{className:"".concat(l().container),ref:o,children:(0,a.jsx)("canvas",{ref:s})})]})}},3755:e=>{e.exports={slider:"Slider_slider___YTcp"}},2494:e=>{e.exports={container:"SLAMCamera_container__GO4HU",fadeIn:"SLAMCamera_fadeIn__qEfiM",debugContainer:"SLAMCamera_debugContainer__mjp16"}}}]);