(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[497],{2497:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>b});var a=n(5155),r=n(2115),i=n(2494),l=n.n(i);let o={valueDisplay:{fontSize:"13px",color:"white"}},s=e=>{let{text:t}=e;return(0,a.jsx)("span",{style:o.valueDisplay,children:t})};var u=n(3755),c=n.n(u);let d={container:{gap:"5px",display:"flex",flexDirection:"column"}},f=e=>{let{onValueChanged:t,minValue:n=0,maxValue:i=1,defaultValue:l=.5,step:o=.1,label:u="Label"}=e,[f,x]=(0,r.useState)(l);return(0,a.jsxs)("div",{style:d.container,children:[(0,a.jsx)(s,{text:"".concat(u," ").concat(f)}),(0,a.jsx)("input",{type:"range",min:n,max:i,step:o,value:f,onChange:e=>{let n=e.target.value;x(n),t&&t(n)},className:c().slider})]})},x={container:{alignItems:"left",fontFamily:"Arial, sans-serif"},toggle:{width:"50px",height:"20px",borderRadius:"12px",display:"flex",alignItems:"left",padding:"2.5px",cursor:"pointer",transition:"background-color 0.3s ease",position:"relative"},knob:{width:"15px",height:"15px",backgroundColor:"#fff",borderRadius:"50%",transition:"transform 0.3s ease"}},g=function(e){let{onToggle:t,defaultState:n=!1,activeColor:i="#7466E2",label:l}=e,[o,u]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{u(n)},[n]),(0,a.jsxs)("div",{style:x.container,children:[(0,a.jsx)(s,{text:l}),(0,a.jsx)("div",{style:{...x.toggle,backgroundColor:o?i:"#ccc"},onClick:()=>{let e=!o;u(e),t&&t(e)},children:(0,a.jsx)("div",{style:{...x.knob,transform:o?"translateX(30px)":"translateX(0)"}})})]})},h={button:{padding:"2.5px 15px",backgroundColor:"#E79023",color:"#fff",border:"none",borderRadius:"5px",fontSize:"16px",cursor:"pointer",transition:"background-color 0.3s ease"}},p=function(e){let{onClick:t,label:n="Button",style:r={}}=e;return(0,a.jsx)("button",{style:{...h.button,...r},onClick:t,children:(0,a.jsx)(s,{text:n})})},b=()=>{let e=(0,r.useRef)(!1),[t,i]=(0,r.useState)(!1),[o,s]=(0,r.useState)(!1),u=(0,r.useRef)(null),c=(0,r.useRef)(null);(0,r.useRef)(!0);let d=(0,r.useRef)(new THREE.Vector3(0,0,0)),x=(0,r.useRef)(new THREE.Quaternion(0,0,0,1));(0,r.useRef)(new THREE.Quaternion(0,0,0,1));let h=(0,r.useRef)(null),b=(0,r.useRef)(!0),m=(0,r.useRef)(!0),y=40,w=.95,j=!0,S=!1,R=!1,C=!1;return(0,r.useEffect)(()=>{let t=document.querySelector("a-camera"),a=async()=>{let[{AlvaAR:e},{Camera:t,resize2cover:a,onFrame:i}]=await Promise.all([n.e(834).then(n.bind(n,7834)),n.e(165).then(n.bind(n,8165))]),o=u.current,s=c.current,f=(await t.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,g=a(f.videoWidth,f.videoHeight,o.clientWidth,o.clientHeight);s.width=o.clientWidth,s.height=o.clientHeight,f.style.width="".concat(g.width,"px"),f.style.height="".concat(g.height,"px");let p=await e.Initialize(s.width,s.height,45,y,w,j,S,C);h.current=p,document.body.addEventListener("click",()=>p.reset(),!1);let R=s.getContext("2d",{alpha:!1,desynchronized:!0});function E(e){for(let t of p.getFramePoints())R.fillStyle=e?"#bdffc0":"#ff7575",R.fillRect(t.x,t.y,2,2)}i(()=>{if(R.clearRect(0,0,s.width,s.height),!document.hidden){R.drawImage(f,0,0,f.videoWidth,f.videoHeight,g.x,g.y,g.width,g.height);let e=R.getImageData(0,0,s.width,s.height),t=p.findCameraPose(e);if(t){let e=new THREE.Vector3(t[12],t[13],t[14]),n=new THREE.Matrix4().fromArray(t),a=new THREE.Quaternion().setFromRotationMatrix(n).normalize();e.y=-e.y,e.z=-e.z,a.x=-a.x,m.current?(d.current=d.current.lerp(e,.5),x.current=x.current.normalize().slerp(a,.5).normalize()):(d.current=e,x.current=a),r(d.current),l(x.current),b.current&&E(!0)}else b.current&&E(!1)}return!0},30)};e.current||(e.current=!0,a().then(()=>{i(!0)}).catch(e=>{console.error("Error initializing SLAM:",e)}));let r=e=>{t.setAttribute("position",{x:e.x,y:e.y,z:e.z})},l=e=>{t.setAttribute("quaternion-rotation",{x:e.x,y:e.y,z:e.z,w:e.w})}},[]),(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsxs)("div",{className:"".concat(l().debugContainer),children:[(0,a.jsx)(g,{onToggle:e=>s(e),defaultState:C,activeColor:"#E79023",label:"Show SLAM Controls"}),o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(g,{onToggle:e=>b.current=e,defaultState:!0,label:"Show Features"}),(0,a.jsx)(g,{onToggle:e=>m.current=e,defaultState:!0,label:"Use Interpolation"}),(0,a.jsx)(f,{onValueChanged:e=>y=e,minValue:10,maxValue:100,defaultValue:y,step:1,label:"Frame Max Cell Size:"}),(0,a.jsx)(f,{onValueChanged:e=>w=e,minValue:0,maxValue:1,defaultValue:w,step:.01,label:"Map Keyframe Filtering Ratio:"}),(0,a.jsx)(g,{onToggle:e=>S=e,defaultState:S,label:"Use CLAHE"}),(0,a.jsx)(g,{onToggle:e=>j=e,defaultState:j,label:"Use P3P"}),(0,a.jsx)(g,{onToggle:e=>R=e,defaultState:C,label:"Use Video Stabilisation"}),(0,a.jsx)(g,{onToggle:e=>C=e,defaultState:C,label:"Show Debug Logs"}),(0,a.jsx)(p,{onClick:function(){h.current.reconfigure(y,w,j,S,R,C)},label:"APPLY"})]})]}),(0,a.jsx)("div",{className:"".concat(l().container),ref:u,children:(0,a.jsx)("canvas",{ref:c})})]})}},3755:e=>{e.exports={slider:"Slider_slider___YTcp"}},2494:e=>{e.exports={container:"SLAMCamera_container__GO4HU",fadeIn:"SLAMCamera_fadeIn__qEfiM",debugContainer:"SLAMCamera_debugContainer__mjp16"}}}]);