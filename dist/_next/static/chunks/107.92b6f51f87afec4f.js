(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{3107:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var n=r(5155),i=r(2115),c=r(8441),a=r.n(c);let o=()=>{let e=(0,i.useRef)(null),t=(0,i.useRef)(null),c=(0,i.useRef)(!1),o=(0,i.useRef)(!0),u=(0,i.useRef)(new THREE.Vector3(0,0,0)),l=(0,i.useRef)(new THREE.Quaternion(0,0,0,1));return(0,i.useEffect)(()=>{let n=document.querySelector("a-camera"),i=n.parentNode,a=async()=>{let[{AlvaAR:c},{Camera:a,resize2cover:s,onFrame:d}]=await Promise.all([r.e(834).then(r.bind(r,7834)),r.e(165).then(r.bind(r,8165))]),h=e.current,w=t.current,f=(await a.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,y=s(f.videoWidth,f.videoHeight,h.clientWidth,h.clientHeight);w.width=h.clientWidth,w.height=h.clientHeight,f.style.width="".concat(y.width,"px"),f.style.height="".concat(y.height,"px");let m=await c.Initialize(w.width,w.height);document.body.addEventListener("click",()=>m.reset(),!1);let x=w.getContext("2d",{alpha:!1,desynchronized:!0});d(()=>{if(x.clearRect(0,0,w.width,w.height),!document.hidden){x.drawImage(f,0,0,f.videoWidth,f.videoHeight,y.x,y.y,y.width,y.height);let e=x.getImageData(0,0,w.width,w.height),t=m.findCameraPose(e);if(t){!1==o.current&&(i.setAttribute("look-controls","enabled: false"),o.current=!0);let e=new THREE.Vector3(t[12],t[13],t[14]),r=new THREE.Matrix4().fromArray(t),c=new THREE.Quaternion().setFromRotationMatrix(r),a=new THREE.Vector3(u.current.x,u.current.y,u.current.z).lerp(e,.35),s=new THREE.Quaternion(l.current.x,l.current.y,l.current.z,l.current.w).normalize().slerp(c.normalize(),.35).normalize();u.current=a,i.setAttribute("position",{x:u.current.x,y:-u.current.y,z:-u.current.z}),l.current=s,n.setAttribute("quaternion-rotation",{x:-l.current.x,y:l.current.y,z:l.current.z,w:l.current.w})}else for(let e of(!0==o.current&&(i.setAttribute("position","0 0 0"),l.current={x:-l.current.x,y:-l.current.y,z:-l.current.z,w:l.current.w},n.setAttribute("quaternion-rotation",{x:-l.current.x,y:l.current.y,z:l.current.z,w:l.current.w}),i.setAttribute("look-controls","enabled: true"),o.current=!1),m.getFramePoints()))x.fillStyle="white",x.fillRect(e.x,e.y,2,2)}return!0},30)};c.current||(a().catch(e=>{console.error("Error initializing SLAM:",e)}),c.current=!0)},[]),(0,n.jsx)("div",{className:"".concat(a().container),ref:e,children:(0,n.jsx)("canvas",{ref:t})})}},8441:e=>{e.exports={container:"DeviceCamera_container__j2VGQ",fadeIn:"DeviceCamera_fadeIn__Cr6HF",splash:"DeviceCamera_splash__bimCV",overlay:"DeviceCamera_overlay__fOsCB"}}}]);