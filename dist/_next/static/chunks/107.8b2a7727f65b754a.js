(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{3107:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(5155),a=i(2115),r=i(8441),c=i.n(r);let o=()=>{let e=(0,a.useRef)(null),t=(0,a.useRef)(null),r=(0,a.useRef)(!1),o=(0,a.useRef)(!0);return(0,a.useRef)({x:0,y:0,z:0}),(0,a.useEffect)(()=>{let n=document.querySelector("a-camera"),a=async()=>{let[{AlvaAR:a},{Camera:r,resize2cover:c,onFrame:l}]=await Promise.all([i.e(834).then(i.bind(i,7834)),i.e(165).then(i.bind(i,8165))]),h=e.current,s=t.current,d=(await r.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,u=c(d.videoWidth,d.videoHeight,h.clientWidth,h.clientHeight);s.width=h.clientWidth,s.height=h.clientHeight,d.style.width="".concat(u.width,"px"),d.style.height="".concat(u.height,"px");let f=await a.Initialize(s.width,s.height);document.body.addEventListener("click",()=>f.reset(),!1);let w=s.getContext("2d",{alpha:!1,desynchronized:!0});l(()=>{if(w.clearRect(0,0,s.width,s.height),!document.hidden){w.drawImage(d,0,0,d.videoWidth,d.videoHeight,u.x,u.y,u.width,u.height);let e=w.getImageData(0,0,s.width,s.height),t=f.findCameraPose(e);if(t){let e=n.getAttribute("position"),i=n.getAttribute("quaternion-rotation"),a=new THREE.Vector3(t[12],t[13],t[14]),r=new THREE.Matrix4().fromArray(t),c=new THREE.Quaternion().setFromRotationMatrix(r),o=new THREE.Vector3().lerpVectors(new THREE.Vector3(e.x,e.y,e.z),a,.35),l=new THREE.Quaternion().slerpQuaternions(new THREE.Quaternion(i.x,i.y,i.z,i.w),c,.35);n.setAttribute("position","".concat(o.x," ").concat(-o.y," ").concat(-o.z)),n.setAttribute("quaternion-rotation","".concat(-l.x," ").concat(l.y," ").concat(l.z," ").concat(l.w))}else for(let e of(o.current=!0,f.getFramePoints()))w.fillStyle="white",w.fillRect(e.x,e.y,2,2)}return!0},60)};r.current||(a().catch(e=>{console.error("Error initializing SLAM:",e)}),r.current=!0)},[]),(0,n.jsx)("div",{className:"".concat(c().container),ref:e,children:(0,n.jsx)("canvas",{ref:t})})}},8441:e=>{e.exports={container:"DeviceCamera_container__j2VGQ",fadeIn:"DeviceCamera_fadeIn__Cr6HF",splash:"DeviceCamera_splash__bimCV",overlay:"DeviceCamera_overlay__fOsCB"}}}]);