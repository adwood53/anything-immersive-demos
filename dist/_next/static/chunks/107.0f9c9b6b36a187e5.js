(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[107],{3107:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var n=i(5155),a=i(2115),r=i(8441),o=i.n(r);let c=()=>{let e=(0,a.useRef)(null),t=(0,a.useRef)(null),r=(0,a.useRef)(!1),c=(0,a.useRef)(!0);return(0,a.useRef)({x:0,y:0,z:0}),(0,a.useEffect)(()=>{let n=document.querySelector("a-camera");n.parentNode;let a=async()=>{let[{AlvaAR:a},{Camera:r,resize2cover:o,onFrame:l}]=await Promise.all([i.e(834).then(i.bind(i,7834)),i.e(165).then(i.bind(i,8165))]),s=e.current,d=t.current,h=(await r.Initialize({video:{facingMode:"environment",aspectRatio:16/9,width:{ideal:1280}},audio:!1})).el,u=o(h.videoWidth,h.videoHeight,s.clientWidth,s.clientHeight);d.width=s.clientWidth,d.height=s.clientHeight,h.style.width="".concat(u.width,"px"),h.style.height="".concat(u.height,"px");let f=await a.Initialize(d.width,d.height);document.body.addEventListener("click",()=>f.reset(),!1);let w=d.getContext("2d",{alpha:!1,desynchronized:!0});l(()=>{if(w.clearRect(0,0,d.width,d.height),!document.hidden){w.drawImage(h,0,0,h.videoWidth,h.videoHeight,u.x,u.y,u.width,u.height);let e=w.getImageData(0,0,d.width,d.height),t=f.findCameraPose(e);if(t){n.setAttribute("look-controls","enabled: false");let e=n.getAttribute("position"),i=n.getAttribute("quaternion-rotation"),a=new THREE.Vector3(t[12],t[13],t[14]),r=new THREE.Matrix4().fromArray(t),o=new THREE.Quaternion().setFromRotationMatrix(r),c=new THREE.Vector3().lerpVectors(new THREE.Vector3(e.x,e.y,e.z),a,.35),l=new THREE.Quaternion().slerpQuaternions(new THREE.Quaternion(i.x,i.y,i.z,i.w),o,.35);n.setAttribute("position","".concat(c.x," ").concat(-c.y," ").concat(-c.z)),n.setAttribute("quaternion-rotation","".concat(-l.x," ").concat(l.y," ").concat(l.z," ").concat(l.w))}else for(let e of(n.setAttribute("look-controls","enabled: true"),c.current=!0,f.getFramePoints()))w.fillStyle="white",w.fillRect(e.x,e.y,2,2)}return!0},30)};r.current||(a().catch(e=>{console.error("Error initializing SLAM:",e)}),r.current=!0)},[]),(0,n.jsx)("div",{className:"".concat(o().container),ref:e,children:(0,n.jsx)("canvas",{ref:t})})}},8441:e=>{e.exports={container:"DeviceCamera_container__j2VGQ",fadeIn:"DeviceCamera_fadeIn__Cr6HF",splash:"DeviceCamera_splash__bimCV",overlay:"DeviceCamera_overlay__fOsCB"}}}]);